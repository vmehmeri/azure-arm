{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "existingHubVnetResourceGroup": {
      "defaultValue": "CMN-HUB-VNET-rg",
      "type": "String"
    },
    "existingGoepProdHubJumphostsResourceGroup": {
      "defaultValue": "GOE-HUB-VM-JMPAZRPRDEU-rg",
      "type": "String"
    },
    "existingAppProdHubJumphostsResourceGroup": {
      "defaultValue": "APP-HUB-VM-JMPAZRPRDEU-rg",
      "type": "String"
    },
    "existingGoepNonProdHubJumphostsResourceGroup": {
      "defaultValue": "GOE-HUB-VM-JMPAZRNPREU-rg",
      "type": "String"
    },
    "existingAppNonProdHubJumphostsResourceGroup": {
      "defaultValue": "APP-HUB-VM-JMPAZRNPREU-rg",
      "type": "String"
    },
    "existingHubGatewayResourceGroup": {
      "defaultValue": "CMN-HUB-GW-rg",
      "type": "String"
    },
    "existingHubFirewallResourceGroup": {
      "defaultValue": "CMN-HUB-FW-rg",
      "type": "String"
    },
    "hubVnetName": {
      "defaultValue": "HUB-vnet",
      "type": "String"
    },
    "hubVnetPrefix": {
      "defaultValue": "10.124.0.0/20",
      "type": "String"
    },
    "subnetGoepPrdManagementName": {
      "type": "string",
      "defaultValue": "GOE-PRD-ManagementSubnet"
    },
    "subnetGoepPrdManagementPrefix": {
      "type": "string",
      "defaultValue": "10.124.1.0/25"
    },
    "subnetAppPrdManagementName": {
      "type": "string",
      "defaultValue": "APP-PRD-ManagementSubnet"
    },
    "subnetAppPrdManagementPrefix": {
      "type": "string",
      "defaultValue": "10.124.1.129/25"
    },
    "subnetGoepNprManagementName": {
      "type": "string",
      "defaultValue": "GOE-NPR-ManagementSubnet"
    },
    "subnetGoepNprManagementPrefix": {
      "type": "string",
      "defaultValue": "10.124.2.0/25"
    },
    "subnetAppNprManagementName": {
      "type": "string",
      "defaultValue": "APP-NPR-ManagementSubnet"
    },
    "subnetAppNprManagementPrefix": {
      "type": "string",
      "defaultValue": "10.124.2.129/25"
    },
    "subnetSharedName": {
      "type": "string",
      "defaultValue": "SharedSubnet"
    },
    "subnetSharedPrefix": {
      "type": "string",
      "defaultValue": "10.124.4.0/22"
    },
    "firewallName": {
      "type": "string",
      "defaultValue": "CMN-HUB-fw"
    },
    "firewallSubnetPrefix": {
      "type": "string",
      "defaultValue": "10.124.0.0/25"
    },
    "prdGatewayName": {
      "type": "string",
      "defaultValue": "CMN-HUB-VPN-gw"
    },
    "nprGatewayName": {
      "type": "string",
      "defaultValue": "CMN-HUB-VPN-gw"
    },
    "gatewaySku": {
      "type": "string",
      "defaultValue": "VpnGw1",
      "allowedValues": [
        "Basic",
        "VpnGw1",
        "VpnGw2",
        "VpnGw3"
      ],
      "metadata": {
        "description": "The SKU of the Gateway, if deployed"
      }
    },
    "gatewaySubnetPrefix": {
      "type": "string",
      "defaultValue": "10.124.15.193/26"
    },
    "goepProdWinJumpHosts": {
      "defaultValue": 2,
      "type": "int",
      "minValue": "1",
      "maxValue": "8",
      "metadata": {
        "description": "Number of Windows Jump-Hosts to deploy for GOEP-Production"
      }
    },
    "goepProdWinJmphostVmNamePrefix": {
      "type": "String",
      "defaultValue": "vINFWJHPRDCI",
      "metadata": {
        "description": "VM Prefix for Windows Jump-Hosts in GOEP-Production"
      }
    },
    "appProdWinJumpHosts": {
      "defaultValue": 2,
      "type": "int",
      "minValue": "1",
      "maxValue": "8",
      "metadata": {
        "description": "Number of Windows Jump-Hosts to deploy for APPEASER-Production"
      }
    },
    "appProdWinJmphostVmNamePrefix": {
      "type": "String",
      "defaultValue": "cINFWJHAPPCI",
      "metadata": {
        "description": "VM Prefix for Windows Jump-Hosts in APPEASER-Production"
      }
    },
    "goepNonProdWinJumpHosts": {
      "defaultValue": 2,
      "type": "int",
      "minValue": "1",
      "maxValue": "8",
      "metadata": {
        "description": "Number of Windows Jump-Hosts to deploy for GOEP-NonProduction"
      }
    },
    "goepNonProdWinJmphostVmNamePrefix": {
      "type": "String",
      "defaultValue": "vINFWJHNPRCI",
      "metadata": {
        "description": "VM Prefix for Windows Jump-Hosts in GOEP-NonProduction"
      }
    },
    "appNonProdWinJumpHosts": {
      "defaultValue": 2,
      "type": "int",
      "minValue": "1",
      "maxValue": "8",
      "metadata": {
        "description": "Number of Windows Jump-Hosts to deploy for APPEASER-NonProduction"
      }
    },
    "appNonProdWinJmphostVmNamePrefix": {
      "type": "String",
      "defaultValue": "cINFWJHNPRCI",
      "metadata": {
        "description": "VM Prefix for Windows Jump-Hosts in APPEASER-NonProduction"
      }
    },
    "windowsOSVersion": {
      "type": "string",
      "defaultValue": "2016-Datacenter",
      "allowedValues": [
        "2008-R2-SP1",
        "2012-Datacenter",
        "2012-R2-Datacenter",
        "2016-Nano-Server",
        "2016-Datacenter-with-Containers",
        "2016-Datacenter"
      ],
      "metadata": {
        "description": "The Windows version for Windows Jump-host VMs."
      }
    },
    "winVmSize": {
      "type": "string",
      "defaultValue": "Standard_D3_v2",
      "allowedValues": [
        "Standard_A1_v2",
        "Standard_A2m_v2",
        "Standard_A2_v2",
        "Standard_A4m_v2",
        "Standard_A4_v2",
        "Standard_A8m_v2",
        "Standard_A8_v2",
        "Standard_B1ms",
        "Standard_B1s",
        "Standard_B2ms",
        "Standard_B2s",
        "Standard_B4ms",
        "Standard_B8ms",
        "Standard_D1_v2",
        "Standard_D2_v2",
        "Standard_D3_v2",
        "Standard_D4_v2",
        "Standard_D5_v2",
        "Standard_D11_v2",
        "Standard_D12_v2",
        "Standard_D13_v2",
        "Standard_D14_v2",
        "Standard_D15_v2",
        "Standard_DS1_v2",
        "Standard_DS2_v2",
        "Standard_DS3_v2",
        "Standard_DS4_v2",
        "Standard_DS5_v2"
      ],
      "metadata": {
        "description": "Size for Windows jump-host VMs"
      }
    },
    "winJmphostVmAdminUser": {
      "type": "string",
      "defaultValue": "WinAdmin",
      "metadata": {
        "description": "Username for Windows jump-host VMs"
      }
    },
    "winJmphostVmAdminPass": {
      "type": "securestring",
      "metadata": {
        "description": "Password for Windows jump-host VMs. The password must be between 6-72 characters long and must satisfy at least 3 of password complexity requirements from the following: 1) Contains an uppercase character 2) Contains a lowercase character 3) Contains a numeric digit 4) Contains a special character 5) Control characters are not allowed"
      }
    },
    "goepProdLinuxJumpHosts": {
      "defaultValue": 2,
      "type": "int",
      "minValue": "1",
      "maxValue": "8",
      "metadata": {
        "description": "Number of Linux Jump-Hosts to deploy for GOEP-Production"
      }
    },
    "goepProdLinuxJmphostVmNamePrefix": {
      "type": "String",
      "defaultValue": "vINFJMPPRDCI",
      "metadata": {
        "description": "VM Prefix of Linux Jump-Hosts in GOEP-Production"
      }
    },
    "appProdLinuxJumpHosts": {
      "defaultValue": 2,
      "type": "int",
      "minValue": "1",
      "maxValue": "8",
      "metadata": {
        "description": "Number of Linux Jump-Hosts to deploy for APPEASER-Production"
      }
    },
    "appProdLinuxJmphostVmNamePrefix": {
      "type": "String",
      "defaultValue": "cINFJMPAPPCI",
      "metadata": {
        "description": "VM Prefix of Linux Jump-Hosts in APPEASER-Production"
      }
    },
    "goepNonProdLinuxJumpHosts": {
      "defaultValue": 2,
      "type": "int",
      "minValue": "1",
      "maxValue": "8",
      "metadata": {
        "description": "Number of Linux Jump-Hosts to deploy for GOEP-NonProduction"
      }
    },
    "goepNonProdLinuxJmphostVmNamePrefix": {
      "type": "String",
      "defaultValue": "vINFJMPNPRCI",
      "metadata": {
        "description": "VM Prefix of Linux Jump-Hosts in GOEP-NonProduction"
      }
    },
    "appNonProdLinuxJumpHosts": {
      "defaultValue": 2,
      "type": "int",
      "minValue": "1",
      "maxValue": "8",
      "metadata": {
        "description": "Number of Linux Jump-Hosts to deploy for APPEASER-NonProduction"
      }
    },
    "appNonProdLinuxJmphostVmNamePrefix": {
      "type": "String",
      "defaultValue": "cINFJMPNPRCI",
      "metadata": {
        "description": "VM Prefix of Linux Jump-Hosts in APPEASER-NonProduction"
      }
    },
    "LinuxOSVersion": {
      "type": "string",
      "defaultValue": "7.4",
      "allowedValues": [
        "7.2",
        "7.3",
        "7.4"
      ],
      "metadata": {
        "description": "The RHEL version for Linux Jump-host VMs"
      }
    },
    "linuxVmSize": {
      "type": "string",
      "defaultValue": "Standard_D1_v2",
      "allowedValues": [
        "Standard_A1_v2",
        "Standard_A2m_v2",
        "Standard_A2_v2",
        "Standard_A4m_v2",
        "Standard_A4_v2",
        "Standard_A8m_v2",
        "Standard_A8_v2",
        "Standard_B1ms",
        "Standard_B1s",
        "Standard_B2ms",
        "Standard_B2s",
        "Standard_B4ms",
        "Standard_B8ms",
        "Standard_D1_v2",
        "Standard_D2_v2",
        "Standard_D3_v2",
        "Standard_D4_v2",
        "Standard_D5_v2",
        "Standard_D11_v2",
        "Standard_D12_v2",
        "Standard_D13_v2",
        "Standard_D14_v2",
        "Standard_D15_v2",
        "Standard_DS1_v2",
        "Standard_DS2_v2",
        "Standard_DS3_v2",
        "Standard_DS4_v2",
        "Standard_DS5_v2"
      ],
      "metadata": {
        "description": "Size for Linux jump-host VMs"
      }
    },
    "linuxJmphostVmAdminUser": {
      "type": "string",
      "defaultValue": "LinuxAdmin",
      "metadata": {
        "description": "Username for Linux jump-host VMs"
      }
    },
    "linuxJmphostVmAdminPass": {
      "type": "securestring",
      "metadata": {
        "description": "Password for Linux jump-host VMs. The password must be between 6-72 characters long and must satisfy at least 3 of password complexity requirements from the following: 1) Contains an uppercase character 2) Contains a lowercase character 3) Contains a numeric digit 4) Contains a special character 5) Control characters are not allowed"
      }
    },
    "hubVnetTagValues": {
      "type": "object",
      "defaultValue": {
        "owner": "v.dantas.mehmeri@accenture.com"
      }
    },
    "hubJumpHostsTagValues": {
      "type": "object",
      "defaultValue": {
        "owner": "v.dantas.mehmeri@accenture.com"
      }
    }
  },
  "variables": {
    "hubVnetTemplateURI": "https://raw.githubusercontent.com/vmehmeri/azure-arm/master/rg-hub/nestedtemplates/hubVnetDeploy.json",
    "hubJumpHostsTemplateURI": "https://raw.githubusercontent.com/vmehmeri/azure-arm/master/rg-hub/nestedtemplates/hubJumpHostsDeploy.json",
    "hubFirewallTemplateURI": "https://raw.githubusercontent.com/vmehmeri/azure-arm/master/rg-hub/nestedtemplates/hubFirewallDeploy.json",
    "hubGatewayTemplateURI": "https://raw.githubusercontent.com/vmehmeri/azure-arm/master/rg-hub/nestedtemplates/hubGatewayDeploy.json"
  },
  "resources": [
    {
      "apiVersion": "2018-02-01",
      "name": "hubNetwork",
      "type": "Microsoft.Resources/deployments",
      "resourceGroup": "[parameters('existingHubVnetResourceGroup')]",
      "properties": {
        "mode": "incremental",
        "templateLink": {
          "contentVersion": "1.0.0.0",
          "uri": "[variables('hubVnetTemplateURI')]"
        },
        "parameters": {
          "hubVnetName": { "value": "[parameters('hubVnetName')]" },
          "hubVnetPrefix": { "value": "[parameters('hubVnetPrefix')]" },
          "subnetGoepPrdManagementName": { "value": "[parameters('subnetGoepPrdManagementName')]" },
          "subnetAppPrdManagementPrefix": { "value": "[parameters('subnetAppPrdManagementPrefix')]" },
          "subnetGoepNprManagementName": { "value": "[parameters('subnetGoepNprManagementName')]" },
          "subnetAppNprManagementPrefix": { "value": "[parameters('subnetAppNprManagementPrefix')]" },
          "subnetSharedName": { "value": "[parameters('subnetSharedName')]" },
          "subnetSharedPrefix": { "value": "[parameters('subnetSharedPrefix')]" },
          "tagValues": { "value": "[parameters('hubVnetTagValues')]" }
        }
      }
    },
    {
      "apiVersion": "2018-02-01",
      "name": "hubGoepProductionJumpHosts",
      "type": "Microsoft.Resources/deployments",
      "dependsOn": [
        "[resourceId(parameters('existingHubVnetResourceGroup'), 'Microsoft.Resources/deployments', 'hubVnetTemplate')]"
      ],
      "resourceGroup": "[parameters('existingGoepProdHubJumphostsResourceGroup')]",
      "properties": {
        "mode": "incremental",
        "templateLink": {
          "contentVersion": "1.0.0.0",
          "uri": "[variables('hubJumpHostsTemplateURI')]"
        },
        "parameters": {
          "existingHubVnetResourceGroup": { "value": "[parameters('existingHubVnetResourceGroup')]" },
          "existingHubVnetName": { "value": "[parameters('hubVnetName')]" },
          "existingManagementSubnetName": { "value": "[parameters('subnetGoepPrdManagementName')]" },
          "tagValues": { "value": "[parameters('hubJumpHostsTagValues')]" },
          "winJumpHosts": { "value": "[parameters('goepProdWinJumpHosts')]" },
          "winJmphostVmNamePrefix": { "value": "[parameters('goepProdWinJmphostVmNamePrefix')]" },
          "windowsOSVersion": { "value": "[parameters('windowsOSVersion')]" },
          "winVmSize": { "value": "[parameters('winVmSize')]" },
          "winJmphostVmAdminUser": { "value": "[parameters('winJmphostVmAdminUser')]" },
          "winJmphostVmAdminPass": { "value": "[parameters('winJmphostVmAdminPass')]" },
          "linuxJumpHosts": { "value": "[parameters('goepProdLinuxJumpHosts')]" },
          "linuxJmphostVmNamePrefix": { "value": "[parameters('goepProdLinuxJmphostVmNamePrefix')]" },
          "LinuxOSVersion": { "value": "[parameters('LinuxOSVersion')]" },
          "linuxVmSize": { "value": "[parameters('linuxVmSize')]" },
          "linuxJmphostVmAdminUser": { "value": "[parameters('linuxJmphostVmAdminUser')]" },
          "linuxJmphostVmAdminPass": { "value": "[parameters('linuxJmphostVmAdminPass')]" }
        }
      }
    },
    {
      "apiVersion": "2018-02-01",
      "name": "hubAppProductionJumpHosts",
      "type": "Microsoft.Resources/deployments",
      "dependsOn": [
        "[resourceId(parameters('existingHubVnetResourceGroup'), 'Microsoft.Resources/deployments', 'hubVnetTemplate')]"
      ],
      "resourceGroup": "[parameters('existingAppProdHubJumphostsResourceGroup')]",
      "properties": {
        "mode": "incremental",
        "templateLink": {
          "contentVersion": "1.0.0.0",
          "uri": "[variables('hubJumpHostsTemplateURI')]"
        },
        "parameters": {
          "existingHubVnetResourceGroup": { "value": "[parameters('existingHubVnetResourceGroup')]" },
          "existingHubVnetName": { "value": "[parameters('hubVnetName')]" },
          "existingManagementSubnetName": { "value": "[parameters('subnetAppPrdManagementName')]" },
          "tagValues": { "value": "[parameters('hubJumpHostsTagValues')]" },
          "winJumpHosts": { "value": "[parameters('appProdWinJumpHosts')]" },
          "winJmphostVmNamePrefix": { "value": "[parameters('appProdWinJmphostVmNamePrefix')]" },
          "windowsOSVersion": { "value": "[parameters('windowsOSVersion')]" },
          "winVmSize": { "value": "[parameters('winVmSize')]" },
          "winJmphostVmAdminUser": { "value": "[parameters('winJmphostVmAdminUser')]" },
          "winJmphostVmAdminPass": { "value": "[parameters('winJmphostVmAdminPass')]" },
          "linuxJumpHosts": { "value": "[parameters('appProdLinuxJumpHosts')]" },
          "linuxJmphostVmNamePrefix": { "value": "[parameters('appProdLinuxJmphostVmNamePrefix')]" },
          "LinuxOSVersion": { "value": "[parameters('LinuxOSVersion')]" },
          "linuxVmSize": { "value": "[parameters('linuxVmSize')]" },
          "linuxJmphostVmAdminUser": { "value": "[parameters('linuxJmphostVmAdminUser')]" },
          "linuxJmphostVmAdminPass": { "value": "[parameters('linuxJmphostVmAdminPass')]" }
        }
      }
    },
    {
      "apiVersion": "2018-02-01",
      "name": "hubGoepNonProductionJumpHosts",
      "type": "Microsoft.Resources/deployments",
      "dependsOn": [
        "[resourceId(parameters('existingHubVnetResourceGroup'), 'Microsoft.Resources/deployments', 'hubVnetTemplate')]"
      ],
      "resourceGroup": "[parameters('existingGoepNonProdHubJumphostsResourceGroup')]",
      "properties": {
        "mode": "incremental",
        "templateLink": {
          "contentVersion": "1.0.0.0",
          "uri": "[variables('hubJumpHostsTemplateURI')]"
        },
        "parameters": {
          "existingHubVnetResourceGroup": { "value": "[parameters('existingHubVnetResourceGroup')]" },
          "existingHubVnetName": { "value": "[parameters('hubVnetName')]" },
          "existingManagementSubnetName": { "value": "[parameters('subnetGoepNprManagementName')]" },
          "tagValues": { "value": "[parameters('hubJumpHostsTagValues')]" },
          "winJumpHosts": { "value": "[parameters('goepProdWinJumpHosts')]" },
          "winJmphostVmNamePrefix": { "value": "[parameters('goepNonProdWinJmphostVmNamePrefix')]" },
          "windowsOSVersion": { "value": "[parameters('windowsOSVersion')]" },
          "winVmSize": { "value": "[parameters('winVmSize')]" },
          "winJmphostVmAdminUser": { "value": "[parameters('winJmphostVmAdminUser')]" },
          "winJmphostVmAdminPass": { "value": "[parameters('winJmphostVmAdminPass')]" },
          "linuxJumpHosts": { "value": "[parameters('goepNonProdLinuxJumpHosts')]" },
          "linuxJmphostVmNamePrefix": { "value": "[parameters('goepNonProdLinuxJmphostVmNamePrefix')]" },
          "LinuxOSVersion": { "value": "[parameters('LinuxOSVersion')]" },
          "linuxVmSize": { "value": "[parameters('linuxVmSize')]" },
          "linuxJmphostVmAdminUser": { "value": "[parameters('linuxJmphostVmAdminUser')]" },
          "linuxJmphostVmAdminPass": { "value": "[parameters('linuxJmphostVmAdminPass')]" }
        }
      }
    },
    {
      "apiVersion": "2018-02-01",
      "name": "hubAppNonProductionJumpHosts",
      "type": "Microsoft.Resources/deployments",
      "dependsOn": [
        "[resourceId(parameters('existingHubVnetResourceGroup'), 'Microsoft.Resources/deployments', 'hubVnetTemplate')]"
      ],
      "resourceGroup": "[parameters('existingAppNonProdHubJumphostsResourceGroup')]",
      "properties": {
        "mode": "incremental",
        "templateLink": {
          "contentVersion": "1.0.0.0",
          "uri": "[variables('hubJumpHostsTemplateURI')]"
        },
        "parameters": {
          "existingHubVnetResourceGroup": { "value": "[parameters('existingHubVnetResourceGroup')]" },
          "existingHubVnetName": { "value": "[parameters('hubVnetName')]" },
          "existingManagementSubnetName": { "value": "[parameters('subnetAppNprManagementName')]" },
          "tagValues": { "value": "[parameters('hubJumpHostsTagValues')]" },
          "winJumpHosts": { "value": "[parameters('appNonProdWinJumpHosts')]" },
          "winJmphostVmNamePrefix": { "value": "[parameters('appNonProdWinJmphostVmNamePrefix')]" },
          "windowsOSVersion": { "value": "[parameters('windowsOSVersion')]" },
          "winVmSize": { "value": "[parameters('winVmSize')]" },
          "winJmphostVmAdminUser": { "value": "[parameters('winJmphostVmAdminUser')]" },
          "winJmphostVmAdminPass": { "value": "[parameters('winJmphostVmAdminPass')]" },
          "linuxJumpHosts": { "value": "[parameters('appNonProdLinuxJumpHosts')]" },
          "linuxJmphostVmNamePrefix": { "value": "[parameters('appNonProdLinuxJmphostVmNamePrefix')]" },
          "LinuxOSVersion": { "value": "[parameters('LinuxOSVersion')]" },
          "linuxVmSize": { "value": "[parameters('linuxVmSize')]" },
          "linuxJmphostVmAdminUser": { "value": "[parameters('linuxJmphostVmAdminUser')]" },
          "linuxJmphostVmAdminPass": { "value": "[parameters('linuxJmphostVmAdminPass')]" }
        }
      }
    },
    {
      "apiVersion": "2018-02-01",
      "name": "hubFirewallTemplate",
      "type": "Microsoft.Resources/deployments",
      "dependsOn": [
        "[resourceId(parameters('existingHubVnetResourceGroup'), 'Microsoft.Resources/deployments', 'hubVnetTemplate')]"
      ],
      "resourceGroup": "[parameters('existingHubFirewallResourceGroup')]",
      "properties": {
        "mode": "incremental",
        "templateLink": {
          "contentVersion": "1.0.0.0",
          "uri": "[variables('hubFirewallTemplateURI')]"
        },
        "parameters": {
          "existingHubVnetResourceGroup": { "value": "[parameters('existingHubVnetResourceGroup')]" },
          "existingHubVnetName": { "value": "[parameters('hubVnetName')]" },
          "firewallName": { "value": "[parameters('firewallName')]" },
          "firewallSubnetPrefix": { "value": "[parameters('firewallSubnetPrefix')]" }
        }
      }
    },
    {
      "apiVersion": "2018-02-01",
      "name": "hubPrdGateway",
      "type": "Microsoft.Resources/deployments",
      "dependsOn": [
        "[resourceId(parameters('existingHubVnetResourceGroup'), 'Microsoft.Resources/deployments', 'hubVnetTemplate')]"
      ],
      "resourceGroup": "[parameters('existingHubGatewayResourceGroup')]",
      "properties": {
        "mode": "incremental",
        "templateLink": {
          "contentVersion": "1.0.0.0",
          "uri": "[variables('hubGatewayTemplateURI')]"
        },
        "parameters": {
          "existingHubVnetResourceGroup": { "value": "[parameters('existingHubVnetResourceGroup')]" },
          "existingHubVnetName": { "value": "[parameters('hubVnetName')]" },
          "gatewayName": { "value": "[parameters('prdGatewayName')]" },
          "gatewaySubnetPrefix": { "value": "[parameters('gatewaySubnetPrefix')]" },
          "gatewaySku": { "value": "[parameters('gatewaySku')]" }
        }
      }
    },
    {
      "apiVersion": "2018-02-01",
      "name": "hubNprGateway",
      "type": "Microsoft.Resources/deployments",
      "dependsOn": [
        "[resourceId(parameters('existingHubVnetResourceGroup'), 'Microsoft.Resources/deployments', 'hubVnetTemplate')]",
        "[resourceId(parameters('existingHubGatewayResourceGroup'), 'Microsoft.Resources/deployments', 'hubPrdGateway')]"
      ],
      "resourceGroup": "[parameters('existingHubGatewayResourceGroup')]",
      "properties": {
        "mode": "incremental",
        "templateLink": {
          "contentVersion": "1.0.0.0",
          "uri": "[variables('hubGatewayTemplateURI')]"
        },
        "parameters": {
          "existingHubVnetResourceGroup": { "value": "[parameters('existingHubVnetResourceGroup')]" },
          "existingHubVnetName": { "value": "[parameters('hubVnetName')]" },
          "gatewayName": { "value": "[parameters('nprGatewayName')]" },
          "gatewaySubnetPrefix": { "value": "[parameters('gatewaySubnetPrefix')]" },
          "gatewaySku": { "value": "[parameters('gatewaySku')]" }
        }
      }
    }
  ],
  "outputs": {}
}
